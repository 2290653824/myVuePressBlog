---
title: jvm调优
date: 2023-06-09 17:07:38
permalink: /pages/f070cc/
categories:
  - java
  - java进阶
  - JVM
tags:
  - 
author: 
  name: xugaoyi
  link: https://github.com/xugaoyi
---
调优工具之一：
- jstat

  jstat是一个用于监视Java虚拟机（JVM）统计信息的命令行工具。它可以收集和显示与垃圾回收（GC）、类加载、内存、线程和编译等相关的性能统计数据。

通过使用jstat命令，您可以监视运行中的Java应用程序的各种性能指标，以便进行性能分析、故障排除和优化。jstat命令提供了多种选项和参数，用于指定要收集的统计信息类型、采样间隔和统计数据的输出格式。

以下是jstat命令的基本用法：

```java
jstat [ options ] <vmid> [interval[s|ms] [count]]
```
其中，<vid>是Java应用程序的进程ID或标识符，可以使用jps命令查找。interval指定了采样间隔的时间长度，count指定了采样的次数。如果未指定interval和count，jstat将会持续输出统计信息直到被中断。

`jstat`命令的一些常用选项包括：

- `-gc`: 显示与垃圾回收相关的统计信息。

```git
jstat -gc 27019      
 S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC     YGCT    FGC    FGCT     GCT   
68096.0 54272.0  0.0   54249.6 994816.0 747848.9  291328.0   112888.5  122176.0 116621.0 16488.0 15434.9     15    0.343   4      0.456    0.799
```

S0C：第一个幸存区的大小

S1C：第二个幸存区的大小

S0U：第一个幸存区的使用大小

S1U：第二个幸存区的使用大小

EC：伊甸园区的大小

EU：伊甸园区的使用大小

OC：老年代大小（单位kb）

OU：老年代使用大小

MC：元空间大小

MU：元空间使用大小

CCSC:压缩类空间大小

CCSU:压缩类空间使用大小

YGC：年轻代垃圾回收次数

YGCT：年轻代垃圾回收消耗时间

FGC：老年代垃圾回收次数

FGCT：老年代垃圾回收消耗时间

GCT：垃圾回收消耗总时间

- `-class`: 显示与类加载和卸载相关的统计信息。

```sql
zhengjian@FVFDN0KMP3YV hammurabi % jstat -class 27019
Loaded  Bytes  Unloaded  Bytes     Time   
 24739 45803.1        1     0.9      15.76
```

Loaded:加载class的数量

Bytes：所占用空间大小

Unloaded：未加载数量

Bytes:未加载占用空间

Time：时间

- `-compiler`: 显示与JIT编译器相关的统计信息。

```java
zhengjian@FVFDN0KMP3YV hammurabi % jstat -compiler 27019
Compiled Failed Invalid   Time   FailedType FailedMethod
   14339      7       0     4.92          1 java/util/concurrent/ForkJoinPool tryTerminate
```

Compiled：编译数量。

Failed：失败数量

Invalid：不可用数量

Time：时间

FailedType：失败类型

FailedMethod：失败的方法

- `-gcutil`: 显示垃圾回收统计的摘要信息。
- `-printcompilation`: 打印JIT编译器的编译方法信息。
- `-gccapacity`:堆内存统计

```shell
zhengjian@FVFDN0KMP3YV hammurabi % jstat -gccapacity 46642
 NGCMN    NGCMX     NGC     S0C   S1C       EC      OGCMN      OGCMX       OGC         OC       MCMN     MCMX      MC     CCSMN    CCSMX     CCSC    YGC    FGC 
 87040.0 1397760.0 1397760.0 66560.0 70144.0 1252864.0   175104.0  2796544.0   236544.0   236544.0      0.0 1165312.0 133440.0      0.0 1048576.0  17984.0     17     4
```

NGCMN：新生代最小容量

NGCMX：新生代最大容量

NGC：当前新生代容量

S0C：第一个幸存区大小

S1C：第二个幸存区的大小

EC：伊甸园区的大小

OGCMN：老年代最小容量

OGCMX：老年代最大容量

OGC：当前老年代大小

OC: 当前老年代大小（单位Kb）

MCMN:最小元数据容量

MCMX：最大元数据容量

MC：当前元数据空间大小

CCSMN：最小压缩类空间大小

CCSMX：最大压缩类空间大小

CCSC：当前压缩类空间大小

YGC：年轻代gc次数

FGC：老年代GC次数
